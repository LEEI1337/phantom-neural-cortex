name: Documentation Quality

on:
  push:
    branches: [master]
  pull_request:
    branches: [master]

jobs:
  markdown-lint:
    name: Markdown Lint
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Lint Markdown files
        uses: DavidAnson/markdownlint-cli2-action@v18
        with:
          globs: '**/*.md'
          config: '.markdownlint.json'
        continue-on-error: true

  link-check:
    name: Check Links
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Check links in Markdown files
        uses: gaurav-nelson/github-action-markdown-link-check@v1
        with:
          use-quiet-mode: 'yes'
          config-file: '.markdown-link-check.json'
        continue-on-error: true

  validate-structure:
    name: Validate Repository Structure
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Check required files exist
        run: |
          echo "Checking for required documentation files..."

          required_files=(
            "README.md"
            "LICENSE"
            "CONTRIBUTING.md"
            "CODE_OF_CONDUCT.md"
            "SECURITY.md"
          )

          missing_files=()
          for file in "${required_files[@]}"; do
            if [ ! -f "$file" ]; then
              missing_files+=("$file")
            fi
          done

          if [ ${#missing_files[@]} -gt 0 ]; then
            echo "::warning::Missing files: ${missing_files[*]}"
          else
            echo "✅ All required files present"
          fi

      - name: Check directory structure
        run: |
          echo "Validating directory structure..."

          if [ -d ".github" ]; then
            echo "✅ .github directory exists"
          fi

          if [ -d "docs" ]; then
            echo "✅ docs directory exists"
          fi

          if [ -d ".claude" ]; then
            echo "✅ .claude configuration exists"
          fi

          echo "Repository structure validation complete"
